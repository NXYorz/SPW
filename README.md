# SPW å­¦ä¹ è®¡åˆ’æ‰“å¡ï¼ˆäº‘ç«¯éƒ¨ç½²ç‰ˆï¼‰

ä¸€ä¸ªé¢å‘è®¡ç®—æœºå­¦ç”Ÿçš„ **å­¦ä¹ è®¡åˆ’æ‰“å¡ + å­¦ä¹ èµ„æ–™åº“** ç½‘ç«™ã€‚æ”¯æŒå¤šç”¨æˆ·æ³¨å†Œã€äº‘ç«¯åŒæ­¥ï¼Œå¹¶å…·å¤‡"å…¬å¼€åŠ¨æ€"åŠŸèƒ½ï¼Œæ–¹ä¾¿åŒå­¦é—´äº’ç›¸ç›‘ç£æ¿€åŠ±ã€‚

## ğŸš€ å¿«é€Ÿè®¿é—®

- **çº¿ä¸Šåœ°å€**ï¼šhttp://140.143.131.225/
- **ç®¡ç†å‘˜è´¦å·**ï¼š`admin` / `spw-admin`ï¼ˆé¦–æ¬¡ç™»å½•åå»ºè®®ä¿®æ”¹å¯†ç ï¼‰

## ğŸ“š åŠŸèƒ½æ¦‚è§ˆ

### 1. è´¦å·ä½“ç³»
- **ç”¨æˆ·æ³¨å†Œ/ç™»å½•**ï¼šé»˜è®¤æ™®é€šç”¨æˆ·ï¼Œæ‹¥æœ‰ç§æœ‰è®¡åˆ’ç©ºé—´
- **ç®¡ç†å‘˜æƒé™**ï¼šå†…ç½®ç®¡ç†å‘˜è´¦å·ï¼Œè´Ÿè´£ç»´æŠ¤å…¬å…±å­¦ä¹ èµ„æ–™åº“
- **JWTè®¤è¯**ï¼šåŸºäºTokençš„æ— çŠ¶æ€èº«ä»½éªŒè¯ï¼Œå®‰å…¨å¯é 

### 2. è®¡åˆ’æ‰“å¡ï¼ˆäº‘ç«¯åŒæ­¥ï¼‰
- **æœˆè§†å›¾æ—¥å†**ï¼šç›´è§‚å±•ç¤ºæ¯æ—¥å­¦ä¹ è¿›åº¦
- **è®¡åˆ’ç®¡ç†**ï¼šç‚¹å‡»æ—¥æœŸåˆ›å»ºã€ç¼–è¾‘ã€åˆ é™¤å­¦ä¹ è®¡åˆ’
- **å…¬å¼€/ç§æœ‰**ï¼šæ”¯æŒå°†è®¡åˆ’è®¾ä¸ºå…¬å¼€ï¼Œè®©å…¶ä»–åŒå­¦çœ‹åˆ°ä½ çš„åŠ¨æ€
- **å®æ—¶åŒæ­¥**ï¼šå¯å¼€å¯è‡ªåŠ¨åˆ·æ–°ï¼Œå¤šè®¾å¤‡æ•°æ®å®æ—¶åŒæ­¥

### 3. å­¦ä¹ èµ„æ–™åº“
- **åˆ†ç±»æ£€ç´¢**ï¼šC++ã€ç®—æ³•ã€æ“ä½œç³»ç»Ÿã€ç½‘ç»œã€Node.js ç­‰å¤šåˆ†ç±»
- **æ ‡ç­¾ç­›é€‰**ï¼šæ”¯æŒå¤šæ ‡ç­¾è¿‡æ»¤ï¼Œå¿«é€Ÿæ‰¾åˆ°ç›¸å…³èµ„æ–™
- **ç®¡ç†å‘˜ç»´æŠ¤**ï¼šç®¡ç†å‘˜å¯éšæ—¶å¢åˆ æ”¹æŸ¥ï¼Œå…¨ç«™å®æ—¶ç”Ÿæ•ˆ

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

### æŠ€æœ¯æ ˆ

**å‰ç«¯**ï¼š
- React 18 + TypeScript + Vite
- TailwindCSS + TDesign React (`tdesign-react@1.12.0`)
- å“åº”å¼è®¾è®¡ï¼Œæ”¯æŒæ¡Œé¢å’Œç§»åŠ¨ç«¯

**åç«¯**ï¼š
- Node.js 20 + Express 4
- MySQL 8.0ï¼ˆå·²ä»PostgreSQLè¿ç§»ï¼‰
- JWTèº«ä»½éªŒè¯ + bcryptå¯†ç åŠ å¯†
- Zodæ•°æ®éªŒè¯

**åŸºç¡€è®¾æ–½**ï¼š
- Docker + Docker Composeï¼ˆå®¹å™¨åŒ–éƒ¨ç½²ï¼‰
- Nginxï¼ˆåå‘ä»£ç† + é™æ€æ–‡ä»¶æœåŠ¡ï¼‰
- è…¾è®¯äº‘è½»é‡åº”ç”¨æœåŠ¡å™¨ï¼ˆLighthouseï¼‰

### ç³»ç»Ÿæ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ç”¨æˆ·æµè§ˆå™¨                            â”‚
â”‚               http://140.143.131.225                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚ HTTPè¯·æ±‚
                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Webå®¹å™¨ (Nginx:80)                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  é™æ€æ–‡ä»¶æœåŠ¡: /usr/share/nginx/html              â”‚  â”‚
â”‚  â”‚  - index.html                                    â”‚  â”‚
â”‚  â”‚  - *.js, *.css (Reactæ„å»ºäº§ç‰©)                   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  åå‘ä»£ç†é…ç½®:                                    â”‚  â”‚
â”‚  â”‚  /api/* â†’ http://api:3000/api/*                 â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚ APIè¯·æ±‚ä»£ç†
                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         APIå®¹å™¨ (Node.js:3000)                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Express REST API æœåŠ¡å™¨                         â”‚  â”‚
â”‚  â”‚  â”œâ”€ /api/auth/*      ç”¨æˆ·è®¤è¯ï¼ˆæ³¨å†Œ/ç™»å½•ï¼‰       â”‚  â”‚
â”‚  â”‚  â”œâ”€ /api/plans/*     å­¦ä¹ è®¡åˆ’ç®¡ç†                â”‚  â”‚
â”‚  â”‚  â”œâ”€ /api/resources/* å­¦ä¹ èµ„æ–™ç®¡ç†                â”‚  â”‚
â”‚  â”‚  â””â”€ /api/health      å¥åº·æ£€æŸ¥                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  ä¸­é—´ä»¶å±‚:                                        â”‚  â”‚
â”‚  â”‚  - JWTéªŒè¯ä¸­é—´ä»¶ï¼ˆauthMiddlewareï¼‰               â”‚  â”‚
â”‚  â”‚  - ç®¡ç†å‘˜æƒé™æ£€æŸ¥ï¼ˆrequireAdminï¼‰                 â”‚  â”‚
â”‚  â”‚  - æ•°æ®éªŒè¯ï¼ˆZod Schemaï¼‰                        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚ MySQLè¿æ¥æ± 
                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         DBå®¹å™¨ (MySQL:3306)                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  æ•°æ®åº“: spw                                      â”‚  â”‚
â”‚  â”‚  â”œâ”€ usersè¡¨       ç”¨æˆ·è´¦å·ã€å¯†ç hashã€è§’è‰²        â”‚  â”‚
â”‚  â”‚  â”œâ”€ plansè¡¨       å­¦ä¹ è®¡åˆ’ï¼ˆå…³è”user_idï¼‰         â”‚  â”‚
â”‚  â”‚  â””â”€ resourcesè¡¨   å­¦ä¹ èµ„æ–™ï¼ˆæ ‡ç­¾å­˜å‚¨ä¸ºJSONï¼‰      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  æŒä¹…åŒ–: Docker Volume (spw_mysql_data)          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”§ å®ç°ç»†èŠ‚

### 1. Dockerå®¹å™¨åŒ–æ¶æ„

é¡¹ç›®é€šè¿‡ `docker-compose.yml` å®šä¹‰äº†ä¸‰ä¸ªæœåŠ¡ï¼š

#### **db å®¹å™¨ï¼ˆMySQLæ•°æ®åº“ï¼‰**
```yaml
services:
  db:
    image: mysql:8.0              # ä½¿ç”¨å®˜æ–¹MySQL 8.0é•œåƒ
    ports:
      - "3306:3306"               # å¯¹å¤–å¼€æ”¾3306ç«¯å£
    volumes:
      - spw_mysql_data:/var/lib/mysql           # æ•°æ®æŒä¹…åŒ–
      - ./server/db/init.sql:/.../001-init.sql  # è‡ªåŠ¨æ‰§è¡Œåˆå§‹åŒ–è„šæœ¬
    environment:
      MYSQL_DATABASE: spw         # è‡ªåŠ¨åˆ›å»ºæ•°æ®åº“
      MYSQL_USER: spw
      MYSQL_PASSWORD: spw_mysql_password_change_me
```

**ç‰¹ç‚¹**ï¼š
- ä½¿ç”¨Dockerå·æŒä¹…åŒ–æ•°æ®ï¼Œå®¹å™¨é‡å¯æ•°æ®ä¸ä¸¢å¤±
- é¦–æ¬¡å¯åŠ¨æ—¶è‡ªåŠ¨æ‰§è¡Œ `init.sql` åˆ›å»ºè¡¨ç»“æ„å’Œç®¡ç†å‘˜è´¦å·
- å¥åº·æ£€æŸ¥æœºåˆ¶ç¡®ä¿æ•°æ®åº“å°±ç»ªåå†å¯åŠ¨APIæœåŠ¡

#### **api å®¹å™¨ï¼ˆNode.jsåç«¯ï¼‰**
```dockerfile
# server/Dockerfile
FROM node:20-alpine
WORKDIR /app
COPY package.json ./
RUN npm install --omit=dev      # åªå®‰è£…ç”Ÿäº§ä¾èµ–
COPY src ./src
CMD ["node", "src/index.js"]    # å¯åŠ¨ExpressæœåŠ¡å™¨
```

**ç‰¹ç‚¹**ï¼š
- ä½¿ç”¨è½»é‡çº§ Alpine Linux é•œåƒï¼ˆä½“ç§¯ä»…5MBï¼‰
- ç”Ÿäº§ç¯å¢ƒåªå®‰è£…å¿…è¦ä¾èµ–ï¼Œå‡å°é•œåƒä½“ç§¯
- `depends_on` é…ç½®ç¡®ä¿æ•°æ®åº“å¥åº·åæ‰å¯åŠ¨

#### **web å®¹å™¨ï¼ˆNginxå‰ç«¯ï¼‰**
```dockerfile
# Dockerfile (å¤šé˜¶æ®µæ„å»º)
# é˜¶æ®µ1: æ„å»ºå‰ç«¯
FROM node:20-alpine AS build
WORKDIR /app
COPY package.json package-lock.json ./
RUN npm ci                      # å®‰è£…æ‰€æœ‰ä¾èµ–ï¼ˆåŒ…æ‹¬å¼€å‘ä¾èµ–ï¼‰
COPY . .
RUN npm run build               # Viteæ„å»º â†’ dist/

# é˜¶æ®µ2: ç”Ÿäº§ç¯å¢ƒ
FROM nginx:1.25-alpine
COPY ./nginx.conf /etc/nginx/conf.d/default.conf
COPY --from=build /app/dist /usr/share/nginx/html  # åªå¤åˆ¶æ„å»ºäº§ç‰©
```

**ç‰¹ç‚¹**ï¼š
- **å¤šé˜¶æ®µæ„å»º**ï¼šç¬¬ä¸€é˜¶æ®µæ„å»ºå‰ç«¯ï¼Œç¬¬äºŒé˜¶æ®µåªä¿ç•™é™æ€æ–‡ä»¶ï¼Œå‡å°é•œåƒä½“ç§¯90%
- Nginxé…ç½®åå‘ä»£ç†ï¼Œå°† `/api/*` è¯·æ±‚è½¬å‘åˆ°APIå®¹å™¨
- æ”¯æŒSPAè·¯ç”±ï¼Œæ‰€æœ‰è·¯ç”±è¿”å› `index.html` ç”±React Routerå¤„ç†

### 2. æ•°æ®åº“è®¾è®¡

#### **users è¡¨ï¼ˆç”¨æˆ·ï¼‰**
```sql
CREATE TABLE users (
  id BIGINT AUTO_INCREMENT PRIMARY KEY,
  username VARCHAR(100) UNIQUE NOT NULL,
  password_hash VARCHAR(100) NOT NULL,    -- bcryptåŠ å¯†
  role VARCHAR(20) DEFAULT 'user',        -- 'user' æˆ– 'admin'
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

#### **plans è¡¨ï¼ˆå­¦ä¹ è®¡åˆ’ï¼‰**
```sql
CREATE TABLE plans (
  id BIGINT AUTO_INCREMENT PRIMARY KEY,
  user_id BIGINT NOT NULL,
  date VARCHAR(10) NOT NULL,              -- æ ¼å¼ï¼šYYYY-MM-DD
  title VARCHAR(200) NOT NULL,
  category VARCHAR(50),                   -- åˆ†ç±»ï¼šç®—æ³•/é¡¹ç›®/é˜…è¯»ç­‰
  minutes INT DEFAULT 0,                  -- è®¡åˆ’å­¦ä¹ æ—¶é•¿ï¼ˆåˆ†é’Ÿï¼‰
  done BOOLEAN DEFAULT FALSE,             -- æ˜¯å¦å®Œæˆ
  notes TEXT,                             -- ç¬”è®°
  public BOOLEAN DEFAULT FALSE,           -- æ˜¯å¦å…¬å¼€
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  FOREIGN KEY (user_id) REFERENCES users(id)
);
```

#### **resources è¡¨ï¼ˆå­¦ä¹ èµ„æ–™ï¼‰**
```sql
CREATE TABLE resources (
  id BIGINT AUTO_INCREMENT PRIMARY KEY,
  title VARCHAR(200) NOT NULL,
  category VARCHAR(50) NOT NULL,          -- åˆ†ç±»ï¼šC++/ç®—æ³•/ç½‘ç»œç­‰
  type VARCHAR(20) NOT NULL,              -- ç±»å‹ï¼šè§†é¢‘/æ–‡ç« /æ–‡æ¡£ç­‰
  url VARCHAR(500) NOT NULL,
  summary TEXT,
  tags JSON,                              -- æ ‡ç­¾æ•°ç»„ï¼Œå­˜å‚¨ä¸ºJSONæ ¼å¼
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);
```

### 3. åç«¯APIæ¶æ„

#### **ç›®å½•ç»“æ„**
```
server/src/
â”œâ”€â”€ index.js        # ExpressæœåŠ¡å™¨ä¸»å…¥å£ + æ‰€æœ‰APIè·¯ç”±
â”œâ”€â”€ auth.js         # JWTç”Ÿæˆ/éªŒè¯ + è®¤è¯ä¸­é—´ä»¶
â”œâ”€â”€ db.js           # MySQLè¿æ¥æ± é…ç½®
â””â”€â”€ resources.js    # æ•°æ®éªŒè¯Schemaå®šä¹‰ï¼ˆZodï¼‰
```

#### **æ ¸å¿ƒåŠŸèƒ½å®ç°**

**èº«ä»½éªŒè¯æµç¨‹**ï¼š
```javascript
// 1. ç”¨æˆ·æ³¨å†Œ
POST /api/auth/register
â†’ éªŒè¯ç”¨æˆ·å/å¯†ç æ ¼å¼ï¼ˆZod Schemaï¼‰
â†’ æ£€æŸ¥ç”¨æˆ·åæ˜¯å¦å·²å­˜åœ¨
â†’ bcryptåŠ å¯†å¯†ç ï¼ˆ10è½®saltï¼‰
â†’ æ’å…¥æ•°æ®åº“
â†’ ç”ŸæˆJWT token
â†’ è¿”å› { token, user }

// 2. ç”¨æˆ·ç™»å½•
POST /api/auth/login
â†’ æŸ¥è¯¢ç”¨æˆ·
â†’ bcryptéªŒè¯å¯†ç 
â†’ ç”ŸæˆJWT tokenï¼ˆåŒ…å«userIdã€usernameã€roleï¼‰
â†’ è¿”å› { token, user }

// 3. å—ä¿æŠ¤çš„API
GET /api/plans
â†’ authMiddlewareéªŒè¯JWT token
â†’ ä»tokenæå–userId
â†’ æŸ¥è¯¢è¯¥ç”¨æˆ·çš„è®¡åˆ’
â†’ è¿”å›æ•°æ®
```

**æ•°æ®éªŒè¯ç¤ºä¾‹**ï¼š
```javascript
// resources.js - ä½¿ç”¨Zodå®šä¹‰æ•°æ®ç»“æ„
export const resourceUpsertSchema = z.object({
  title: z.string().min(1).max(120),
  category: z.string().min(1).max(50),
  type: z.string().min(1).max(20),
  url: z.string().url().max(400),      // å¿…é¡»æ˜¯æœ‰æ•ˆURL
  summary: z.string().min(1).max(2000),
  tags: z.array(z.string()).max(8).default([]),
});

// index.js - åœ¨APIä¸­ä½¿ç”¨
app.post('/api/resources', authMiddleware, requireAdmin, async (req, res) => {
  const parsed = resourceUpsertSchema.safeParse(req.body);
  if (!parsed.success) {
    return res.status(400).json({ error: 'BAD_REQUEST' });
  }
  // éªŒè¯é€šè¿‡ï¼Œæ‰§è¡Œæ•°æ®åº“æ“ä½œ
});
```

**æ•°æ®åº“è¿æ¥æ± **ï¼š
```javascript
// db.js
import mysql from 'mysql2/promise';

export function createPool() {
  const connectionString = process.env.DATABASE_URL;
  // mysql://spw:password@db:3306/spw
  return mysql.createPool(connectionString);
}

// ä½¿ç”¨è¿æ¥æ± æ‰§è¡ŒæŸ¥è¯¢
const [rows] = await pool.query('SELECT * FROM users WHERE id = ?', [userId]);
```

### 4. å‰ç«¯å®ç°

#### **çŠ¶æ€ç®¡ç†**
ä½¿ç”¨React Hooksè¿›è¡ŒçŠ¶æ€ç®¡ç†ï¼š
```typescript
// å…¨å±€çŠ¶æ€ï¼šç”¨æˆ·ä¿¡æ¯ã€Token
const [user, setUser] = useState<User | null>(null);
const [token, setToken] = useState<string>('');

// è®¡åˆ’æ•°æ®çŠ¶æ€
const [plans, setPlans] = useState<Plan[]>([]);
const [selectedDate, setSelectedDate] = useState<string>('');

// è‡ªåŠ¨åˆ·æ–°
useEffect(() => {
  if (autoRefresh) {
    const interval = setInterval(() => fetchPlans(), 5000);
    return () => clearInterval(interval);
  }
}, [autoRefresh]);
```

#### **APIè°ƒç”¨å°è£…**
```typescript
// src/lib/api.ts
const API_BASE = '/api';  // Nginxä¼šä»£ç†åˆ° http://api:3000/api

export async function register(username: string, password: string) {
  const res = await fetch(`${API_BASE}/auth/register`, {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ username, password }),
  });
  return res.json();
}

export async function getPlans(token: string, date: string) {
  const res = await fetch(`${API_BASE}/plans?date=${date}`, {
    headers: { 'Authorization': `Bearer ${token}` },
  });
  return res.json();
}
```

### 5. Nginxåå‘ä»£ç†é…ç½®

```nginx
server {
  listen 80;
  root /usr/share/nginx/html;
  
  # APIè¯·æ±‚ä»£ç†åˆ°åç«¯
  location /api/ {
    proxy_pass http://api:3000/api/;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
  }
  
  # SPAè·¯ç”±æ”¯æŒ
  location / {
    try_files $uri $uri/ /index.html;  # æ‰€æœ‰è·¯ç”±è¿”å›index.html
  }
  
  # é™æ€èµ„æºç¼“å­˜
  location ~* \.(js|css|png|jpg|svg|ico)$ {
    expires 7d;
    add_header Cache-Control "public";
  }
}
```

## ğŸ“¦ éƒ¨ç½²æµç¨‹

### æœ¬åœ°å¼€å‘
```bash
# 1. å…‹éš†é¡¹ç›®
git clone <repository-url>
cd study-checkin

# 2. å¯åŠ¨æ‰€æœ‰æœåŠ¡
docker compose up -d

# 3. æŸ¥çœ‹æ—¥å¿—
docker compose logs -f

# 4. è®¿é—®åº”ç”¨
# å‰ç«¯: http://localhost
# APIå¥åº·æ£€æŸ¥: http://localhost/api/health
# MySQL: localhost:3306 (ç”¨æˆ·å: spw, å¯†ç : spw_mysql_password_change_me)
```

### ç”Ÿäº§éƒ¨ç½²ï¼ˆLighthouseæœåŠ¡å™¨ï¼‰
```bash
# 1. ä¸Šä¼ é¡¹ç›®æ–‡ä»¶åˆ°æœåŠ¡å™¨
# 2. æ„å»ºå¹¶å¯åŠ¨å®¹å™¨
cd /root/study-checkin_20260130170447
docker compose up -d

# 3. æŸ¥çœ‹å®¹å™¨çŠ¶æ€
docker compose ps

# 4. éªŒè¯æœåŠ¡
curl http://localhost/api/health
# é¢„æœŸè¾“å‡º: {"ok":true,"db":1}
```

### æ•°æ®åº“ç®¡ç†
```bash
# æ–¹å¼1: é€šè¿‡dockerå‘½ä»¤è¡Œè¿æ¥
docker compose exec db mysql -uspw -pspw_mysql_password_change_me spw

# æ–¹å¼2: ä½¿ç”¨GUIå·¥å…·ï¼ˆæ¨èï¼‰
# ä¸»æœº: 140.143.131.225
# ç«¯å£: 3306
# ç”¨æˆ·å: spw
# å¯†ç : spw_mysql_password_change_me
# æ•°æ®åº“: spw
# æ¨èå·¥å…·: Navicat / MySQL Workbench / DBeaver
```

## ğŸ”’ å®‰å…¨æœºåˆ¶

1. **å¯†ç åŠ å¯†**ï¼šä½¿ç”¨ bcrypt åŠ å¯†å­˜å‚¨ï¼Œ10è½®saltï¼Œé˜²æ­¢å½©è™¹è¡¨æ”»å‡»
2. **JWTè®¤è¯**ï¼šæ— çŠ¶æ€Tokenè®¤è¯ï¼Œé¿å…Sessionå­˜å‚¨å¼€é”€
3. **æƒé™æ§åˆ¶**ï¼šç®¡ç†å‘˜æƒé™æ£€æŸ¥ä¸­é—´ä»¶ï¼Œä¿æŠ¤æ•æ„ŸAPI
4. **è¾“å…¥éªŒè¯**ï¼šæ‰€æœ‰APIä½¿ç”¨Zodè¿›è¡Œä¸¥æ ¼çš„æ•°æ®éªŒè¯
5. **SQLæ³¨å…¥é˜²æŠ¤**ï¼šä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢ï¼ˆ`?` å ä½ç¬¦ï¼‰ï¼Œé˜²æ­¢SQLæ³¨å…¥
6. **CORSé…ç½®**ï¼šæ§åˆ¶è·¨åŸŸè®¿é—®ï¼Œç”Ÿäº§ç¯å¢ƒåº”é…ç½®ç™½åå•

## ğŸš§ æŠ€æœ¯äº®ç‚¹

1. **Dockerå¤šé˜¶æ®µæ„å»º**ï¼šå‰ç«¯æ„å»ºé•œåƒä»…30MBï¼Œå¤§å¹…å‡å°ä½“ç§¯å’Œéƒ¨ç½²æ—¶é—´
2. **å¾®æœåŠ¡æ¶æ„**ï¼šWeb/API/DBä¸‰å±‚è§£è€¦ï¼Œç‹¬ç«‹æ‰©å±•å’Œç»´æŠ¤
3. **æ•°æ®åº“è¿ç§»**ï¼šä»PostgreSQLå¹³æ»‘è¿ç§»åˆ°MySQLï¼ŒAPIå±‚ä»£ç æ”¹åŠ¨æœ€å°
4. **å¥åº·æ£€æŸ¥æœºåˆ¶**ï¼šå®¹å™¨å¯åŠ¨é¡ºåºæ§åˆ¶ï¼Œç¡®ä¿ä¾èµ–æœåŠ¡å°±ç»ª
5. **æ•°æ®æŒä¹…åŒ–**ï¼šDockerå·ç®¡ç†æ•°æ®ï¼Œå®¹å™¨é‡å¯æ•°æ®ä¸ä¸¢å¤±
6. **å“åº”å¼è®¾è®¡**ï¼šTailwindCSS + TDesignï¼Œå®Œç¾é€‚é…æ¡Œé¢å’Œç§»åŠ¨ç«¯

## ğŸ“ å¼€å‘ç¬”è®°

### ä¿®æ”¹æ•°æ®åº“é…ç½®
ç¼–è¾‘ `docker-compose.yml`ï¼Œä¿®æ”¹ç¯å¢ƒå˜é‡åé‡æ–°æ„å»ºï¼š
```bash
docker compose down
docker compose up -d --build
```

### æŸ¥çœ‹æ—¥å¿—
```bash
docker compose logs web      # æŸ¥çœ‹å‰ç«¯æ—¥å¿—
docker compose logs api      # æŸ¥çœ‹åç«¯æ—¥å¿—
docker compose logs db       # æŸ¥çœ‹æ•°æ®åº“æ—¥å¿—
docker compose logs -f       # å®æ—¶æŸ¥çœ‹æ‰€æœ‰æ—¥å¿—
```

### æ•°æ®åº“å¤‡ä»½ä¸æ¢å¤
```bash
# å¤‡ä»½
docker compose exec db mysqldump -uspw -pspw_mysql_password_change_me spw > backup.sql

# æ¢å¤
docker compose exec -T db mysql -uspw -pspw_mysql_password_change_me spw < backup.sql
```

## ğŸ“„ License

æœ¬é¡¹ç›®ä»…ä¾›å­¦ä¹ äº¤æµä½¿ç”¨ã€‚
